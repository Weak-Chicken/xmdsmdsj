# Article Part

## Showing Articles on Our Page

---

### Goal

Now we have finished the very basic logging in system. Although there are still many bugs in there (For example, you have to re-login if refreshing the page.), I will leave it there and maybe working on that later. For now, our priority is to build our article displaying page.

In this part, our main job is to make basic article uploading, showing and deleting functions. It requires:

1. Logged in user can upload articles into their account. 
2. Logged in user can see all its articles in its account page. Logged in user can see a button on their account page to let them upload their articles.
3. When articles are uploaded, database will record its uploaded time, last modified time etc. Anyway, extra infomation will be recorded.
4. Uploaded articles will be shown in '/article/', no matter which user uploaded it. The title of it will be shown with a hyperlink to the details of this article.
5. Click on article page could get into the article, where you can read the article and see the details.

---

### Steps

1. Create fake data in frontend for articles.

> First, according to our working procedure, we need to first create our fake data in data provider for our frontend. Then, after well tested, write this fake data structure into our API document and implement it in our backend and database. Therefore, the fake data need to be considered seriously.
> 
> Inspired by [cnodejs topic API](https://cnodejs.org/api/v1/topics/?page=1&limit=10), I decide to define my fake data with these extra data. Here it contains only three articles as an example.
> 
> The fake data is in the form of:
> 
> ```json
> "success": true,
> "articles": [
>   {
>     "article_id": "testArticleId0",
>     "user_id": "testUserId0",
>     "title": "article0",
>     "created_at": "2019-05-02T04:32:09.537Z",
>     "last_modified_at": "2019-05-02T04:32:09.537Z",
>     "author": {
>       "userName": "Jon",
>     },
>     "content": "content_here",
>   },
> 
>   ...
> ]
> 
> ```
> 
> So 7 items are defined in this standard.
> 
> Now, the next step is to insert this fake data into our page. When changing my old code to be usable with new data provider, I realized an old problem I left here: How do I get arcitle details when I clicked on the title of one article in post page? Originally, I send html file as a parameter through router to new article page. However, this is clearly bad. First, it's not working when the user refreshing their page. Once the user refreshes an article page, this page will lost its html data.
> 
> So, there's only one solution to this: send another request to the backend to obtain the details of specific article. To do this, we'll need a new API to obtain articles by their Ids. Besides, since we don't need details when just posting them, we should remove 'content' from our posts API to increase its speed.
> 
> So now our article related APIs are changed to this:
> 
> ```js
> mountingPoint.getAllArticlesPosts = (succeeded) => {
>   if (succeeded) {
>     return {
>       "success": true,
>       "articles": [
>         {
>           "article_id": "testArticleId0",
>           "user_id": "testUserId0",
>           "title": "Authentication System Part 1",
>           "created_at": "2019-05-02T04:32:09.537Z",
>           "last_modified_at": "2019-05-02T04:32:09.537Z",
>           "author": {
>             "userName": "Jon",
>           },
>         },
> 
>         ...
>
>       ]
>     }
>   }
> }
> ```
> 
> And the get articles by id one:
> 
> ```json
> mountingPoint.getArticlesById = (succeeded, article_id) => {
>   if (succeeded) {
>     console.log(article_id);
>     let fakeAllArticles = [
>       {
>         "article_id": "testArticleId0",
>         "user_id": "testUserId0",
>         "title": "Authentication System Part 1",
>         "created_at": "2019-05-02T04:32:09.537Z",
>         "last_modified_at": "2019-05-02T04:32:09.537Z",
>         "author": {
>           "userName": "Jon",
>         },
>         "content": fakeArticle0,
>       },
>       
>       ...
>       
>     ];
> 
>     return {
>       "success": true,
>       "article": fakeAllArticles.filter(article => article.article_id === article_id)[0]
>     }
>   } else {
>     ...
>     }
>   }
> };
> ```
> 
> And now, our web can fetch and show these fake data properly. (Quite ugly, although)

2. Enable frontend authentication control

> In this part, we will finish the authentication control functions illustrated in our goals. In specific, we need to let users to see their articles in their personal page and let them to upload/edit/delete their articles.
> 
> First, we need to make a new API to specially obtain articles published by specific user. It is be very similar to ```getArticlesById``` API, so here I will not repeat this part.
> 
> Then, I realized that in my orginal Vuex user login status, I only recorded the user name of logged in user. However, it would be much better(And also more reliable) to use user id for distinguishing different users. So here I need to make some modifications on my Vuex. Meanwhile, although using user id is a better choise, we still need some other user infomation such as user name to be displayed on our page. To avoid requesting user data again and again, here I decide to store all available except user sensitive data (Password, for example) in Vuex to improve performance.
> 
> And I also added some data verification in Vuex so that if deverlopers give wrong data to Vuex, they can be warned in time.
> 
> Now, my Vuex looks like this:
> 
> state.js
> 
> ```js
> export default {
>   loggedIn: false,
>   userData: {},
> }
> ```
> 
> mutations.js
>
> ```js
> export default {
>   LOGGING_IN(state, userData) {
>     state.loggedIn = true;
>     state.userData = userData;
>   },
> 
>   LOGGING_OUT(state) {
>     state.loggedIn = false;
>     state.userData = {};
>   },
> }
> ```
> 
> actions.js
>
> ```js
> export default {
>   loggingIn({ commit }, userData) {
>     commit('LOGGING_IN', userData);
>   },
> 
>   loggingOut({ commit }) {
>     commit('LOGGING_OUT');
>   },
> }
> 
> ```
> 
> getters.js
> 
> ```js
> export default {
>   checkLogin: function (state) {
>     return state.loggedIn;
>   },
>   getUserData: function (state) {
>     return state.userData;
>   },
> }
> ```
> 
> By the way, I think it is worth mentioning that, during modifying my Vuex componets, I think the name for 'state' is not proper. Therefore, I changed it into 'states', which cause a problem that the store componets cannot recognize it. So I changed it back. I spent about half an hour to locate the problem! So don't renaming anything cause that might cause problems!